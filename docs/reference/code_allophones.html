<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Code allophones — code_allophones • joeyr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Code allophones — code_allophones"><meta property="og:description" content="A function to classify vowel data into contextual allophones."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@joey_stan"><meta name="twitter:site" content="@joey_stan"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-86802921-3"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-86802921-3');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">joeyr</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.8.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/JoeyStanley/joeyr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Code allophones</h1>
    <small class="dont-index">Source: <a href="https://github.com/JoeyStanley/joeyr/blob/HEAD/R/sociophonetics.R" class="external-link"><code>R/sociophonetics.R</code></a></small>
    <div class="hidden name"><code>code_allophones.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A function to classify vowel data into contextual allophones.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">code_allophones</span><span class="op">(</span></span>
<span>  <span class="va">.df</span>,</span>
<span>  <span class="va">.old_col</span>,</span>
<span>  .new_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"allophone"</span>, <span class="st">"allophone_environment"</span><span class="op">)</span>,</span>
<span>  <span class="va">.pre_seg</span>,</span>
<span>  <span class="va">.fol_seg</span>,</span>
<span>  .coronals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"T"</span>, <span class="st">"D"</span>, <span class="st">"S"</span>, <span class="st">"Z"</span>, <span class="st">"SH"</span>, <span class="st">"ZH"</span>, <span class="st">"JH"</span>, <span class="st">"N"</span><span class="op">)</span>,</span>
<span>  .voiceless <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P"</span>, <span class="st">"T"</span>, <span class="st">"K"</span>, <span class="st">"CH"</span>, <span class="st">"F"</span>, <span class="st">"TH"</span>, <span class="st">"S"</span>, <span class="st">"SH"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>.df</dt>
<dd><p>The dataset containing vowel data.</p></dd>


<dt>.old_col</dt>
<dd><p>The unquoted name of the column containing the vowel labels.
Often called "vowel" or "phoneme" in many datasets. Note that the function
assumes Wells lexical sets (FLEECE, TRAP, etc.) rather than ARPABET (IY, AE, etc.)
or IPA (i, æ, etc.). If your vowels are not already coded using Wells' labels
you can quickly do so with <code>switch_transcriptions</code> or one of the
shortcuts like <code>arpa_to_wells</code></p></dd>


<dt>.new_cols</dt>
<dd><p>A vector of two strings containing the names of the columns
you would like to use. By default <code>c("allophone", "allophone_environment")</code>.
The first name becomes the name of the column containing the new allophone
labels. The second column becomes the name of the column describing those
labels.</p></dd>


<dt>.pre_seg</dt>
<dd><p>The unquoted name of the column that contains the labels for
the previous segement. In DARLA-generated spreadsheets, this is `pre_seg` and
in FastTrack-generated spreadsheets, it's `previous_sound`. Assumes ARPABET
labels.</p></dd>


<dt>.fol_seg</dt>
<dd><p>The unquoted name of the column that contains the labels for
the following segement. In DARLA-generated spreadsheets, this is `fol_seg` and
in FastTrack-generated spreadsheets, it's `next_sound`. Assumes ARPABET labels.</p></dd>


<dt>.coronals</dt>
<dd><p>A vector of strings containing ARPABET labels for coronal consonants.
By default, <code>c("T", "D", "S", "Z", "SH", "ZH", "JH", "N")</code>. This is used
to create the `TOOT` allophone of `GOOSE`.</p></dd>


<dt>.voiceless</dt>
<dd><p>A vector of strings containing ARPABET labels for voiceless
consonants. By default, <code>c("P", "T", "K", "CH", "F", "TH", "S", "SH")</code>.
This is used to create the `PRICE` allophone of `PRIZE`.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A dataframe with two additional columns. One column contains labels
for the allophones and the other contains category labels for those
allophones' contexts. The second column can be useful for quickly excluding
certain allophones like prelaterals or prerhotics or coloring families of
allophones in visualizations (such as turning all prelateral allophones gray).
These two new columns are positioned immediately after the original vowel
column indicated in <code>.old_col</code>,</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Here are the list of the contextual allophones that are created. Note
that I largely follow my own advice about what to call <a href="https://joeystanley.com/blog/why-do-people-use-bat-instead-of-trap" class="external-link">elsewhere allophones</a>,
what to call <a href="https://joeystanley.com/blog/extending-wells-lexical-sets-to-prelateral-vowels" class="external-link">prelateral allophones</a>,
and <a href="https://joeystanley.com/blog/thoughts-on-allophonic-extensions-to-wells-lexical-sets" class="external-link">other allophones</a>.
Obviously, this list is pretty subjective and largely based on what my own
research has needed, so it may not work completely for you and your research.
Please contact me at <a href="mailto:joey_stanley@byu.edu">joey_stanley@byu.edu</a> if you want to see an allophone
get added or if you spot an error in the coding.</p>
<ul><li><p>FLEECE becomes</p><ul><li><p>ZEAL before laterals</p></li>
<li><p>BEET elsewhere</p></li>
</ul></li>
<li><p>KIT becomes</p><ul><li><p>GUILT before laterals</p></li>
<li><p>NEAR before rhotics</p></li>
<li><p>BIG before G</p></li>
<li><p>BIN before M and N</p></li>
<li><p>BING before NG</p></li>
<li><p>BIT elsewhere</p></li>
</ul></li>
<li><p>FACE becomes</p><ul><li><p>FLAIL before laterals</p></li>
<li><p>VAGUE before G</p></li>
<li><p>BAIT elsewhere</p></li>
</ul></li>
<li><p>DRESS becomes</p><ul><li><p>SHELF before laterals</p></li>
<li><p>SQUARE before rhotics</p></li>
<li><p>BEG before G</p></li>
<li><p>BEN before M and N</p></li>
<li><p>BENG before NG</p></li>
<li><p>BET elsewhere</p></li>
</ul></li>
<li><p>TRAP becomes</p><ul><li><p>TALC before laterals</p></li>
<li><p>BAG before G</p></li>
<li><p>BAN before M and N</p></li>
<li><p>BANG before NG</p></li>
<li><p>BAT elsewhere</p></li>
</ul></li>
<li><p>LOT becomes</p><ul><li><p>GOLF before laterals</p></li>
<li><p>START before rhotics</p></li>
<li><p>BOT elsewhere</p></li>
</ul></li>
<li><p>THOUGHT becomes</p><ul><li><p>FAULT before laterals</p></li>
<li><p>FORCE befpre rhotics</p></li>
<li><p>BOUGHT elsewhere</p></li>
</ul></li>
<li><p>STRUT becomes</p><ul><li><p>MULCH before laterals</p></li>
<li><p>BUT elsewhere</p></li>
</ul></li>
<li><p>GOAT becomes</p><ul><li><p>JOLT before laterals</p></li>
<li><p>BOAT elsewhere</p></li>
</ul></li>
<li><p>FOOT becomes</p><ul><li><p>WOLF before laterals</p></li>
<li><p>CURE before rhotics</p></li>
<li><p>PUT elsewhere</p></li>
</ul></li>
<li><p>GOOSE becomes</p><ul><li><p>MULE before Y</p></li>
<li><p>TOOT before coronals</p></li>
<li><p>SPOOL before laterals</p></li>
<li><p>BOOT elsewhere</p></li>
</ul></li>
<li><p>PRICE becomes</p><ul><li><p>PRICE before voiceless segments</p></li>
<li><p>PRIZE elsewhere</p></li>
</ul></li>
</ul><p>Unfortunately, it is not straightforward to customize this list but you can
always copy the source code and modify the list yourself.</p>
<p>Alternatively, you can use <code><a href="https://forcats.tidyverse.org/reference/fct_collapse.html" class="external-link">forcats::fct_collapse()</a></code> to collapse
distinctions that you don't need. See example code below.</p>
<p>You can also of course create your own allophones if desired. Note that some
allophones depend on other environmental information like syllable structure and
morpheme/word boundaries, or they may be entirely lexical (FORCE vs. NORTH).
They may be more complicated than what ARPABET can code for (MARY, MERRY, and
MARRY) or just inconsistently coded. For the sake of simplicity, these
allophones are not included in this function.</p>
<p>The environments therefore are the following</p><ul><li><p>"prelateral" includes ZEAL, GUILT, FLAIL, SHELF, TALC, GOLF, FAULT, MULCH, JOLT, WOLF, SPOOL</p></li>
<li><p>"prerhotic" includes NEAR, SQUARE, START, FORCE, CURE</p></li>
<li><p>"prevelar" includes BIG, VAGUE, BEG, BAG,</p></li>
<li><p>"prenasal" includes BIN, BEN, BAN</p></li>
<li><p>"prevelarnasal" includes BING, BENG, BANG</p></li>
<li><p>"prevoiceless" includes PRICE</p></li>
<li><p>"post-Y" includes MULE</p></li>
<li><p>"postcoronal" includes TOOT</p></li>
<li><p>"elsewhere" includes BEET, BIT, BAIT, BET, BAT, BOT, BOUGHT, BUT, BOAT, PUT, BOOT, PRIZE</p></li>
</ul></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get some sample DARLA data to play with</span></span></span>
<span class="r-in"><span><span class="va">darla</span> <span class="op">&lt;-</span> <span class="fu">joeysvowels</span><span class="fu">::</span><span class="va">darla</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">word</span>, <span class="va">vowel</span>, <span class="va">pre_seg</span>, <span class="va">fol_seg</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>phoneme <span class="op">=</span> <span class="fu">joeyr</span><span class="fu">:::</span><span class="fu"><a href="switch_transcriptions.html">arpa_to_wells</a></span><span class="op">(</span><span class="va">vowel</span><span class="op">)</span>, .after <span class="op">=</span> <span class="va">vowel</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in loadNamespace(x):</span> there is no package called ‘joeysvowels’</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Basic usage</span></span></span>
<span class="r-in"><span><span class="va">darla</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">code_allophones</span><span class="op">(</span>.old_col <span class="op">=</span> <span class="va">phoneme</span>, .fol_seg <span class="op">=</span> <span class="va">fol_seg</span>, .pre_seg <span class="op">=</span> <span class="va">pre_seg</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in mutate(., `:=`({    {        new_allophone_colname    }}, case_when({    {        .old_col    }} == "FLEECE" ~ case_when({    {        .fol_seg    }} == "L" ~ "ZEAL", TRUE ~ "BEET"), {    {        .old_col    }} == "KIT" ~ case_when({    {        .fol_seg    }} == "L" ~ "GUILT", {    {        .fol_seg    }} == "R" ~ "NEAR", {    {        .fol_seg    }} == "G" ~ "BIG", {    {        .fol_seg    }} %in% c("M", "N") ~ "BIN", {    {        .fol_seg    }} == "NG" ~ "BING", TRUE ~ "BIT"), {    {        .old_col    }} == "FACE" ~ case_when({    {        .fol_seg    }} == "L" ~ "FLAIL", {    {        .fol_seg    }} == "G" ~ "VAGUE", TRUE ~ "BAIT"), {    {        .old_col    }} == "DRESS" ~ case_when({    {        .fol_seg    }} == "L" ~ "SHELF", {    {        .fol_seg    }} == "R" ~ "SQUARE", {    {        .fol_seg    }} == "G" ~ "BEG", {    {        .fol_seg    }} %in% c("M", "N") ~ "BEN", {    {        .fol_seg    }} == "NG" ~ "BENG", TRUE ~ "BET"), {    {        .old_col    }} == "TRAP" ~ case_when({    {        .fol_seg    }} == "L" ~ "TALC", {    {        .fol_seg    }} == "G" ~ "BAG", {    {        .fol_seg    }} %in% c("M", "N") ~ "BAN", {    {        .fol_seg    }} == "NG" ~ "BANG", TRUE ~ "BAT"), {    {        .old_col    }} == "LOT" ~ case_when({    {        .fol_seg    }} == "L" ~ "GOLF", {    {        .fol_seg    }} == "R" ~ "START", TRUE ~ "BOT"), {    {        .old_col    }} == "THOUGHT" ~ case_when({    {        .fol_seg    }} == "L" ~ "FAULT", {    {        .fol_seg    }} == "R" ~ "FORCE", TRUE ~ "BOUGHT"), {    {        .old_col    }} == "STRUT" ~ case_when({    {        .fol_seg    }} == "L" ~ "MULCH", TRUE ~ "BUT"), {    {        .old_col    }} == "GOAT" ~ case_when({    {        .fol_seg    }} == "L" ~ "JOLT", TRUE ~ "BOAT"), {    {        .old_col    }} == "FOOT" ~ case_when({    {        .fol_seg    }} == "L" ~ "WOLF", {    {        .fol_seg    }} == "R" ~ "CURE", TRUE ~ "PUT"), {    {        .old_col    }} == "GOOSE" ~ case_when({    {        .pre_seg    }} == "Y" ~ "MULE", {    {        .fol_seg    }} == "L" ~ "SPOOL", {    {        .pre_seg    }} %in% .coronals ~ "TOOT", TRUE ~ "BOOT"), {    {        .old_col    }} == "PRICE" ~ case_when({    {        .fol_seg    }} %in% .voiceless ~ "PRICE", TRUE ~ "PRIZE"), TRUE ~ as.character({    {        .old_col    }}))), .after = {    {        .old_col    }}):</span> object 'darla' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Specify the names of the new columns with the `.new_cols` argument</span></span></span>
<span class="r-in"><span><span class="va">darla</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">code_allophones</span><span class="op">(</span>.old_col <span class="op">=</span> <span class="va">phoneme</span>,</span></span>
<span class="r-in"><span>                  .new_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"allophone"</span>, <span class="st">"environment"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  .fol_seg <span class="op">=</span> <span class="va">fol_seg</span>,</span></span>
<span class="r-in"><span>                  .pre_seg <span class="op">=</span> <span class="va">pre_seg</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in mutate(., `:=`({    {        new_allophone_colname    }}, case_when({    {        .old_col    }} == "FLEECE" ~ case_when({    {        .fol_seg    }} == "L" ~ "ZEAL", TRUE ~ "BEET"), {    {        .old_col    }} == "KIT" ~ case_when({    {        .fol_seg    }} == "L" ~ "GUILT", {    {        .fol_seg    }} == "R" ~ "NEAR", {    {        .fol_seg    }} == "G" ~ "BIG", {    {        .fol_seg    }} %in% c("M", "N") ~ "BIN", {    {        .fol_seg    }} == "NG" ~ "BING", TRUE ~ "BIT"), {    {        .old_col    }} == "FACE" ~ case_when({    {        .fol_seg    }} == "L" ~ "FLAIL", {    {        .fol_seg    }} == "G" ~ "VAGUE", TRUE ~ "BAIT"), {    {        .old_col    }} == "DRESS" ~ case_when({    {        .fol_seg    }} == "L" ~ "SHELF", {    {        .fol_seg    }} == "R" ~ "SQUARE", {    {        .fol_seg    }} == "G" ~ "BEG", {    {        .fol_seg    }} %in% c("M", "N") ~ "BEN", {    {        .fol_seg    }} == "NG" ~ "BENG", TRUE ~ "BET"), {    {        .old_col    }} == "TRAP" ~ case_when({    {        .fol_seg    }} == "L" ~ "TALC", {    {        .fol_seg    }} == "G" ~ "BAG", {    {        .fol_seg    }} %in% c("M", "N") ~ "BAN", {    {        .fol_seg    }} == "NG" ~ "BANG", TRUE ~ "BAT"), {    {        .old_col    }} == "LOT" ~ case_when({    {        .fol_seg    }} == "L" ~ "GOLF", {    {        .fol_seg    }} == "R" ~ "START", TRUE ~ "BOT"), {    {        .old_col    }} == "THOUGHT" ~ case_when({    {        .fol_seg    }} == "L" ~ "FAULT", {    {        .fol_seg    }} == "R" ~ "FORCE", TRUE ~ "BOUGHT"), {    {        .old_col    }} == "STRUT" ~ case_when({    {        .fol_seg    }} == "L" ~ "MULCH", TRUE ~ "BUT"), {    {        .old_col    }} == "GOAT" ~ case_when({    {        .fol_seg    }} == "L" ~ "JOLT", TRUE ~ "BOAT"), {    {        .old_col    }} == "FOOT" ~ case_when({    {        .fol_seg    }} == "L" ~ "WOLF", {    {        .fol_seg    }} == "R" ~ "CURE", TRUE ~ "PUT"), {    {        .old_col    }} == "GOOSE" ~ case_when({    {        .pre_seg    }} == "Y" ~ "MULE", {    {        .fol_seg    }} == "L" ~ "SPOOL", {    {        .pre_seg    }} %in% .coronals ~ "TOOT", TRUE ~ "BOOT"), {    {        .old_col    }} == "PRICE" ~ case_when({    {        .fol_seg    }} %in% .voiceless ~ "PRICE", TRUE ~ "PRIZE"), TRUE ~ as.character({    {        .old_col    }}))), .after = {    {        .old_col    }}):</span> object 'darla' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Filtering by environment is straightforward</span></span></span>
<span class="r-in"><span><span class="va">darla</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">code_allophones</span><span class="op">(</span>.old_col <span class="op">=</span> <span class="va">phoneme</span>,</span></span>
<span class="r-in"><span>                  .new_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"allophone"</span>, <span class="st">"environment"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  .fol_seg <span class="op">=</span> <span class="va">fol_seg</span>,</span></span>
<span class="r-in"><span>                  .pre_seg <span class="op">=</span> <span class="va">pre_seg</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">environment</span> <span class="op">==</span> <span class="st">"elsewhere"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in mutate(., `:=`({    {        new_allophone_colname    }}, case_when({    {        .old_col    }} == "FLEECE" ~ case_when({    {        .fol_seg    }} == "L" ~ "ZEAL", TRUE ~ "BEET"), {    {        .old_col    }} == "KIT" ~ case_when({    {        .fol_seg    }} == "L" ~ "GUILT", {    {        .fol_seg    }} == "R" ~ "NEAR", {    {        .fol_seg    }} == "G" ~ "BIG", {    {        .fol_seg    }} %in% c("M", "N") ~ "BIN", {    {        .fol_seg    }} == "NG" ~ "BING", TRUE ~ "BIT"), {    {        .old_col    }} == "FACE" ~ case_when({    {        .fol_seg    }} == "L" ~ "FLAIL", {    {        .fol_seg    }} == "G" ~ "VAGUE", TRUE ~ "BAIT"), {    {        .old_col    }} == "DRESS" ~ case_when({    {        .fol_seg    }} == "L" ~ "SHELF", {    {        .fol_seg    }} == "R" ~ "SQUARE", {    {        .fol_seg    }} == "G" ~ "BEG", {    {        .fol_seg    }} %in% c("M", "N") ~ "BEN", {    {        .fol_seg    }} == "NG" ~ "BENG", TRUE ~ "BET"), {    {        .old_col    }} == "TRAP" ~ case_when({    {        .fol_seg    }} == "L" ~ "TALC", {    {        .fol_seg    }} == "G" ~ "BAG", {    {        .fol_seg    }} %in% c("M", "N") ~ "BAN", {    {        .fol_seg    }} == "NG" ~ "BANG", TRUE ~ "BAT"), {    {        .old_col    }} == "LOT" ~ case_when({    {        .fol_seg    }} == "L" ~ "GOLF", {    {        .fol_seg    }} == "R" ~ "START", TRUE ~ "BOT"), {    {        .old_col    }} == "THOUGHT" ~ case_when({    {        .fol_seg    }} == "L" ~ "FAULT", {    {        .fol_seg    }} == "R" ~ "FORCE", TRUE ~ "BOUGHT"), {    {        .old_col    }} == "STRUT" ~ case_when({    {        .fol_seg    }} == "L" ~ "MULCH", TRUE ~ "BUT"), {    {        .old_col    }} == "GOAT" ~ case_when({    {        .fol_seg    }} == "L" ~ "JOLT", TRUE ~ "BOAT"), {    {        .old_col    }} == "FOOT" ~ case_when({    {        .fol_seg    }} == "L" ~ "WOLF", {    {        .fol_seg    }} == "R" ~ "CURE", TRUE ~ "PUT"), {    {        .old_col    }} == "GOOSE" ~ case_when({    {        .pre_seg    }} == "Y" ~ "MULE", {    {        .fol_seg    }} == "L" ~ "SPOOL", {    {        .pre_seg    }} %in% .coronals ~ "TOOT", TRUE ~ "BOOT"), {    {        .old_col    }} == "PRICE" ~ case_when({    {        .fol_seg    }} %in% .voiceless ~ "PRICE", TRUE ~ "PRIZE"), TRUE ~ as.character({    {        .old_col    }}))), .after = {    {        .old_col    }}):</span> object 'darla' not found</span>
<span class="r-in"><span><span class="va">darla</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">code_allophones</span><span class="op">(</span>.old_col <span class="op">=</span> <span class="va">phoneme</span>,</span></span>
<span class="r-in"><span>                  .new_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"allophone"</span>, <span class="st">"environment"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  .fol_seg <span class="op">=</span> <span class="va">fol_seg</span>,</span></span>
<span class="r-in"><span>                  .pre_seg <span class="op">=</span> <span class="va">pre_seg</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">environment</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"prerhotic"</span>, <span class="st">"prevelarnasal"</span>, <span class="st">"prevelar"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in mutate(., `:=`({    {        new_allophone_colname    }}, case_when({    {        .old_col    }} == "FLEECE" ~ case_when({    {        .fol_seg    }} == "L" ~ "ZEAL", TRUE ~ "BEET"), {    {        .old_col    }} == "KIT" ~ case_when({    {        .fol_seg    }} == "L" ~ "GUILT", {    {        .fol_seg    }} == "R" ~ "NEAR", {    {        .fol_seg    }} == "G" ~ "BIG", {    {        .fol_seg    }} %in% c("M", "N") ~ "BIN", {    {        .fol_seg    }} == "NG" ~ "BING", TRUE ~ "BIT"), {    {        .old_col    }} == "FACE" ~ case_when({    {        .fol_seg    }} == "L" ~ "FLAIL", {    {        .fol_seg    }} == "G" ~ "VAGUE", TRUE ~ "BAIT"), {    {        .old_col    }} == "DRESS" ~ case_when({    {        .fol_seg    }} == "L" ~ "SHELF", {    {        .fol_seg    }} == "R" ~ "SQUARE", {    {        .fol_seg    }} == "G" ~ "BEG", {    {        .fol_seg    }} %in% c("M", "N") ~ "BEN", {    {        .fol_seg    }} == "NG" ~ "BENG", TRUE ~ "BET"), {    {        .old_col    }} == "TRAP" ~ case_when({    {        .fol_seg    }} == "L" ~ "TALC", {    {        .fol_seg    }} == "G" ~ "BAG", {    {        .fol_seg    }} %in% c("M", "N") ~ "BAN", {    {        .fol_seg    }} == "NG" ~ "BANG", TRUE ~ "BAT"), {    {        .old_col    }} == "LOT" ~ case_when({    {        .fol_seg    }} == "L" ~ "GOLF", {    {        .fol_seg    }} == "R" ~ "START", TRUE ~ "BOT"), {    {        .old_col    }} == "THOUGHT" ~ case_when({    {        .fol_seg    }} == "L" ~ "FAULT", {    {        .fol_seg    }} == "R" ~ "FORCE", TRUE ~ "BOUGHT"), {    {        .old_col    }} == "STRUT" ~ case_when({    {        .fol_seg    }} == "L" ~ "MULCH", TRUE ~ "BUT"), {    {        .old_col    }} == "GOAT" ~ case_when({    {        .fol_seg    }} == "L" ~ "JOLT", TRUE ~ "BOAT"), {    {        .old_col    }} == "FOOT" ~ case_when({    {        .fol_seg    }} == "L" ~ "WOLF", {    {        .fol_seg    }} == "R" ~ "CURE", TRUE ~ "PUT"), {    {        .old_col    }} == "GOOSE" ~ case_when({    {        .pre_seg    }} == "Y" ~ "MULE", {    {        .fol_seg    }} == "L" ~ "SPOOL", {    {        .pre_seg    }} %in% .coronals ~ "TOOT", TRUE ~ "BOOT"), {    {        .old_col    }} == "PRICE" ~ case_when({    {        .fol_seg    }} %in% .voiceless ~ "PRICE", TRUE ~ "PRIZE"), TRUE ~ as.character({    {        .old_col    }}))), .after = {    {        .old_col    }}):</span> object 'darla' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Some users may want to supply their own list of coronal consonants.</span></span></span>
<span class="r-in"><span><span class="va">darla</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">code_allophones</span><span class="op">(</span>.old_col <span class="op">=</span> <span class="va">phoneme</span>,</span></span>
<span class="r-in"><span>                  .new_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"allophone"</span>, <span class="st">"environment"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  .fol_seg <span class="op">=</span> <span class="va">fol_seg</span>,</span></span>
<span class="r-in"><span>                  .pre_seg <span class="op">=</span> <span class="va">pre_seg</span>,</span></span>
<span class="r-in"><span>                  .coronals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"T"</span>, <span class="st">"D"</span>, <span class="st">"S"</span>, <span class="st">"Z"</span>, <span class="st">"SH"</span>, <span class="st">"ZH"</span>, <span class="st">"JH"</span>, <span class="st">"N"</span>, <span class="st">"Y"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">phoneme</span> <span class="op">==</span> <span class="st">"GOOSE"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in mutate(., `:=`({    {        new_allophone_colname    }}, case_when({    {        .old_col    }} == "FLEECE" ~ case_when({    {        .fol_seg    }} == "L" ~ "ZEAL", TRUE ~ "BEET"), {    {        .old_col    }} == "KIT" ~ case_when({    {        .fol_seg    }} == "L" ~ "GUILT", {    {        .fol_seg    }} == "R" ~ "NEAR", {    {        .fol_seg    }} == "G" ~ "BIG", {    {        .fol_seg    }} %in% c("M", "N") ~ "BIN", {    {        .fol_seg    }} == "NG" ~ "BING", TRUE ~ "BIT"), {    {        .old_col    }} == "FACE" ~ case_when({    {        .fol_seg    }} == "L" ~ "FLAIL", {    {        .fol_seg    }} == "G" ~ "VAGUE", TRUE ~ "BAIT"), {    {        .old_col    }} == "DRESS" ~ case_when({    {        .fol_seg    }} == "L" ~ "SHELF", {    {        .fol_seg    }} == "R" ~ "SQUARE", {    {        .fol_seg    }} == "G" ~ "BEG", {    {        .fol_seg    }} %in% c("M", "N") ~ "BEN", {    {        .fol_seg    }} == "NG" ~ "BENG", TRUE ~ "BET"), {    {        .old_col    }} == "TRAP" ~ case_when({    {        .fol_seg    }} == "L" ~ "TALC", {    {        .fol_seg    }} == "G" ~ "BAG", {    {        .fol_seg    }} %in% c("M", "N") ~ "BAN", {    {        .fol_seg    }} == "NG" ~ "BANG", TRUE ~ "BAT"), {    {        .old_col    }} == "LOT" ~ case_when({    {        .fol_seg    }} == "L" ~ "GOLF", {    {        .fol_seg    }} == "R" ~ "START", TRUE ~ "BOT"), {    {        .old_col    }} == "THOUGHT" ~ case_when({    {        .fol_seg    }} == "L" ~ "FAULT", {    {        .fol_seg    }} == "R" ~ "FORCE", TRUE ~ "BOUGHT"), {    {        .old_col    }} == "STRUT" ~ case_when({    {        .fol_seg    }} == "L" ~ "MULCH", TRUE ~ "BUT"), {    {        .old_col    }} == "GOAT" ~ case_when({    {        .fol_seg    }} == "L" ~ "JOLT", TRUE ~ "BOAT"), {    {        .old_col    }} == "FOOT" ~ case_when({    {        .fol_seg    }} == "L" ~ "WOLF", {    {        .fol_seg    }} == "R" ~ "CURE", TRUE ~ "PUT"), {    {        .old_col    }} == "GOOSE" ~ case_when({    {        .pre_seg    }} == "Y" ~ "MULE", {    {        .fol_seg    }} == "L" ~ "SPOOL", {    {        .pre_seg    }} %in% .coronals ~ "TOOT", TRUE ~ "BOOT"), {    {        .old_col    }} == "PRICE" ~ case_when({    {        .fol_seg    }} %in% .voiceless ~ "PRICE", TRUE ~ "PRIZE"), TRUE ~ as.character({    {        .old_col    }}))), .after = {    {        .old_col    }}):</span> object 'darla' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Other users may want to specify their own list of voiceless consonants.</span></span></span>
<span class="r-in"><span><span class="va">darla</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">code_allophones</span><span class="op">(</span>.old_col <span class="op">=</span> <span class="va">phoneme</span>,</span></span>
<span class="r-in"><span>                  .new_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"allophone"</span>, <span class="st">"environment"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  .fol_seg <span class="op">=</span> <span class="va">fol_seg</span>,</span></span>
<span class="r-in"><span>                  .pre_seg <span class="op">=</span> <span class="va">pre_seg</span>,</span></span>
<span class="r-in"><span>                  .voiceless <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P"</span>, <span class="st">"T"</span>, <span class="st">"K"</span>, <span class="st">"CH"</span>, <span class="st">"F"</span>, <span class="st">"TH"</span>, <span class="st">"S"</span>, <span class="st">"SH"</span>, <span class="st">"X"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">phoneme</span> <span class="op">==</span> <span class="st">"PRICE"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in mutate(., `:=`({    {        new_allophone_colname    }}, case_when({    {        .old_col    }} == "FLEECE" ~ case_when({    {        .fol_seg    }} == "L" ~ "ZEAL", TRUE ~ "BEET"), {    {        .old_col    }} == "KIT" ~ case_when({    {        .fol_seg    }} == "L" ~ "GUILT", {    {        .fol_seg    }} == "R" ~ "NEAR", {    {        .fol_seg    }} == "G" ~ "BIG", {    {        .fol_seg    }} %in% c("M", "N") ~ "BIN", {    {        .fol_seg    }} == "NG" ~ "BING", TRUE ~ "BIT"), {    {        .old_col    }} == "FACE" ~ case_when({    {        .fol_seg    }} == "L" ~ "FLAIL", {    {        .fol_seg    }} == "G" ~ "VAGUE", TRUE ~ "BAIT"), {    {        .old_col    }} == "DRESS" ~ case_when({    {        .fol_seg    }} == "L" ~ "SHELF", {    {        .fol_seg    }} == "R" ~ "SQUARE", {    {        .fol_seg    }} == "G" ~ "BEG", {    {        .fol_seg    }} %in% c("M", "N") ~ "BEN", {    {        .fol_seg    }} == "NG" ~ "BENG", TRUE ~ "BET"), {    {        .old_col    }} == "TRAP" ~ case_when({    {        .fol_seg    }} == "L" ~ "TALC", {    {        .fol_seg    }} == "G" ~ "BAG", {    {        .fol_seg    }} %in% c("M", "N") ~ "BAN", {    {        .fol_seg    }} == "NG" ~ "BANG", TRUE ~ "BAT"), {    {        .old_col    }} == "LOT" ~ case_when({    {        .fol_seg    }} == "L" ~ "GOLF", {    {        .fol_seg    }} == "R" ~ "START", TRUE ~ "BOT"), {    {        .old_col    }} == "THOUGHT" ~ case_when({    {        .fol_seg    }} == "L" ~ "FAULT", {    {        .fol_seg    }} == "R" ~ "FORCE", TRUE ~ "BOUGHT"), {    {        .old_col    }} == "STRUT" ~ case_when({    {        .fol_seg    }} == "L" ~ "MULCH", TRUE ~ "BUT"), {    {        .old_col    }} == "GOAT" ~ case_when({    {        .fol_seg    }} == "L" ~ "JOLT", TRUE ~ "BOAT"), {    {        .old_col    }} == "FOOT" ~ case_when({    {        .fol_seg    }} == "L" ~ "WOLF", {    {        .fol_seg    }} == "R" ~ "CURE", TRUE ~ "PUT"), {    {        .old_col    }} == "GOOSE" ~ case_when({    {        .pre_seg    }} == "Y" ~ "MULE", {    {        .fol_seg    }} == "L" ~ "SPOOL", {    {        .pre_seg    }} %in% .coronals ~ "TOOT", TRUE ~ "BOOT"), {    {        .old_col    }} == "PRICE" ~ case_when({    {        .fol_seg    }} %in% .voiceless ~ "PRICE", TRUE ~ "PRIZE"), TRUE ~ as.character({    {        .old_col    }}))), .after = {    {        .old_col    }}):</span> object 'darla' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Collapsing distinctions can be done post hoc (though it may take extra work to get the environment column to match.)</span></span></span>
<span class="r-in"><span><span class="va">darla</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">code_allophones</span><span class="op">(</span>.old_col <span class="op">=</span> <span class="va">phoneme</span>,</span></span>
<span class="r-in"><span>                  .new_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"allophone"</span>, <span class="st">"environment"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  .fol_seg <span class="op">=</span> <span class="va">fol_seg</span>,</span></span>
<span class="r-in"><span>                  .pre_seg <span class="op">=</span> <span class="va">pre_seg</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="co"># Get a subset for demonstration purposes</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">allophone</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BIT"</span>, <span class="st">"BIG"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">allophone</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="co"># Now collapse distinctions</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>allophone <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_collapse.html" class="external-link">fct_collapse</a></span><span class="op">(</span><span class="va">allophone</span>, <span class="st">"BIT"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BIT"</span>, <span class="st">"BIG"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         environment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">allophone</span> <span class="op">==</span> <span class="st">"BIT"</span>, <span class="st">"elsewhere"</span>, <span class="va">allophone</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in mutate(., `:=`({    {        new_allophone_colname    }}, case_when({    {        .old_col    }} == "FLEECE" ~ case_when({    {        .fol_seg    }} == "L" ~ "ZEAL", TRUE ~ "BEET"), {    {        .old_col    }} == "KIT" ~ case_when({    {        .fol_seg    }} == "L" ~ "GUILT", {    {        .fol_seg    }} == "R" ~ "NEAR", {    {        .fol_seg    }} == "G" ~ "BIG", {    {        .fol_seg    }} %in% c("M", "N") ~ "BIN", {    {        .fol_seg    }} == "NG" ~ "BING", TRUE ~ "BIT"), {    {        .old_col    }} == "FACE" ~ case_when({    {        .fol_seg    }} == "L" ~ "FLAIL", {    {        .fol_seg    }} == "G" ~ "VAGUE", TRUE ~ "BAIT"), {    {        .old_col    }} == "DRESS" ~ case_when({    {        .fol_seg    }} == "L" ~ "SHELF", {    {        .fol_seg    }} == "R" ~ "SQUARE", {    {        .fol_seg    }} == "G" ~ "BEG", {    {        .fol_seg    }} %in% c("M", "N") ~ "BEN", {    {        .fol_seg    }} == "NG" ~ "BENG", TRUE ~ "BET"), {    {        .old_col    }} == "TRAP" ~ case_when({    {        .fol_seg    }} == "L" ~ "TALC", {    {        .fol_seg    }} == "G" ~ "BAG", {    {        .fol_seg    }} %in% c("M", "N") ~ "BAN", {    {        .fol_seg    }} == "NG" ~ "BANG", TRUE ~ "BAT"), {    {        .old_col    }} == "LOT" ~ case_when({    {        .fol_seg    }} == "L" ~ "GOLF", {    {        .fol_seg    }} == "R" ~ "START", TRUE ~ "BOT"), {    {        .old_col    }} == "THOUGHT" ~ case_when({    {        .fol_seg    }} == "L" ~ "FAULT", {    {        .fol_seg    }} == "R" ~ "FORCE", TRUE ~ "BOUGHT"), {    {        .old_col    }} == "STRUT" ~ case_when({    {        .fol_seg    }} == "L" ~ "MULCH", TRUE ~ "BUT"), {    {        .old_col    }} == "GOAT" ~ case_when({    {        .fol_seg    }} == "L" ~ "JOLT", TRUE ~ "BOAT"), {    {        .old_col    }} == "FOOT" ~ case_when({    {        .fol_seg    }} == "L" ~ "WOLF", {    {        .fol_seg    }} == "R" ~ "CURE", TRUE ~ "PUT"), {    {        .old_col    }} == "GOOSE" ~ case_when({    {        .pre_seg    }} == "Y" ~ "MULE", {    {        .fol_seg    }} == "L" ~ "SPOOL", {    {        .pre_seg    }} %in% .coronals ~ "TOOT", TRUE ~ "BOOT"), {    {        .old_col    }} == "PRICE" ~ case_when({    {        .fol_seg    }} %in% .voiceless ~ "PRICE", TRUE ~ "PRIZE"), TRUE ~ as.character({    {        .old_col    }}))), .after = {    {        .old_col    }}):</span> object 'darla' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Creating new allophones depends on the complexity of the allophone</span></span></span>
<span class="r-in"><span><span class="va">darla</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">code_allophones</span><span class="op">(</span>.old_col <span class="op">=</span> <span class="va">phoneme</span>,</span></span>
<span class="r-in"><span>                  .new_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"allophone"</span>, <span class="st">"environment"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  .fol_seg <span class="op">=</span> <span class="va">fol_seg</span>,</span></span>
<span class="r-in"><span>                  .pre_seg <span class="op">=</span> <span class="va">pre_seg</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="co"># Create voice and voiceless distinctions for MOUTH</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>allophone <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">phoneme</span> <span class="op">==</span> <span class="st">"MOUTH"</span> <span class="op">&amp;</span> <span class="va">fol_seg</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P"</span>, <span class="st">"T"</span>, <span class="st">"K"</span>, <span class="st">"CH"</span>, <span class="st">"F"</span>, <span class="st">"TH"</span>, <span class="st">"S"</span>, <span class="st">"SH"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"BOUT"</span>,</span></span>
<span class="r-in"><span>                               <span class="va">phoneme</span> <span class="op">==</span> <span class="st">"MOUTH"</span> <span class="op">~</span> <span class="st">"LOUD"</span>,</span></span>
<span class="r-in"><span>                               <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">allophone</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         environment <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">allophone</span> <span class="op">==</span> <span class="st">"BOUT"</span>,  <span class="st">"prevoiceless"</span>, <span class="va">environment</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="co"># Get a subset for demonstration purposes</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">phoneme</span> <span class="op">==</span> <span class="st">"MOUTH"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">allophone</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in mutate(., `:=`({    {        new_allophone_colname    }}, case_when({    {        .old_col    }} == "FLEECE" ~ case_when({    {        .fol_seg    }} == "L" ~ "ZEAL", TRUE ~ "BEET"), {    {        .old_col    }} == "KIT" ~ case_when({    {        .fol_seg    }} == "L" ~ "GUILT", {    {        .fol_seg    }} == "R" ~ "NEAR", {    {        .fol_seg    }} == "G" ~ "BIG", {    {        .fol_seg    }} %in% c("M", "N") ~ "BIN", {    {        .fol_seg    }} == "NG" ~ "BING", TRUE ~ "BIT"), {    {        .old_col    }} == "FACE" ~ case_when({    {        .fol_seg    }} == "L" ~ "FLAIL", {    {        .fol_seg    }} == "G" ~ "VAGUE", TRUE ~ "BAIT"), {    {        .old_col    }} == "DRESS" ~ case_when({    {        .fol_seg    }} == "L" ~ "SHELF", {    {        .fol_seg    }} == "R" ~ "SQUARE", {    {        .fol_seg    }} == "G" ~ "BEG", {    {        .fol_seg    }} %in% c("M", "N") ~ "BEN", {    {        .fol_seg    }} == "NG" ~ "BENG", TRUE ~ "BET"), {    {        .old_col    }} == "TRAP" ~ case_when({    {        .fol_seg    }} == "L" ~ "TALC", {    {        .fol_seg    }} == "G" ~ "BAG", {    {        .fol_seg    }} %in% c("M", "N") ~ "BAN", {    {        .fol_seg    }} == "NG" ~ "BANG", TRUE ~ "BAT"), {    {        .old_col    }} == "LOT" ~ case_when({    {        .fol_seg    }} == "L" ~ "GOLF", {    {        .fol_seg    }} == "R" ~ "START", TRUE ~ "BOT"), {    {        .old_col    }} == "THOUGHT" ~ case_when({    {        .fol_seg    }} == "L" ~ "FAULT", {    {        .fol_seg    }} == "R" ~ "FORCE", TRUE ~ "BOUGHT"), {    {        .old_col    }} == "STRUT" ~ case_when({    {        .fol_seg    }} == "L" ~ "MULCH", TRUE ~ "BUT"), {    {        .old_col    }} == "GOAT" ~ case_when({    {        .fol_seg    }} == "L" ~ "JOLT", TRUE ~ "BOAT"), {    {        .old_col    }} == "FOOT" ~ case_when({    {        .fol_seg    }} == "L" ~ "WOLF", {    {        .fol_seg    }} == "R" ~ "CURE", TRUE ~ "PUT"), {    {        .old_col    }} == "GOOSE" ~ case_when({    {        .pre_seg    }} == "Y" ~ "MULE", {    {        .fol_seg    }} == "L" ~ "SPOOL", {    {        .pre_seg    }} %in% .coronals ~ "TOOT", TRUE ~ "BOOT"), {    {        .old_col    }} == "PRICE" ~ case_when({    {        .fol_seg    }} %in% .voiceless ~ "PRICE", TRUE ~ "PRIZE"), TRUE ~ as.character({    {        .old_col    }}))), .after = {    {        .old_col    }}):</span> object 'darla' not found</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Joseph A. Stanley.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

